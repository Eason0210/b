#!/bin/bash
# return to last checked-out ref.
#
# On Mac, brew install coreutils.
# It's easy to make it work with BSD grep, but you should have GNU grep anyway.

GNU_GREP=$(which ggrep || which grep)

branch=$(git reflog | ${GNU_GREP} -Pom1 '(?<=checkout: moving from )(\S+)')

git checkout "${branch}"
